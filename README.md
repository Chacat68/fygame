# fygame

基于Brackeys教程制作的游戏demo

教程地址：https://youtu.be/LOhfqjmasi0?si=qng6rKh2-j9MwLgN

这是一个基于Brackeys教程制作的游戏demo项目。通过该项目，你可以学习如何使用Godot引擎创建简单的游戏。教程地址提供了详细的教学视频，帮助你逐步完成游戏的制作过程。

![nyFavE](https://blog-1259751088.cos.ap-shanghai.myqcloud.com/uPic/nyFavE.png)

# 游戏玩法规则

## 基本玩法
- 这是一款2D平台跳跃游戏，玩家控制一个骑士角色在平台间移动和跳跃
- 使用A/D或方向键左右移动，空格键跳跃
- 游戏目标是收集尽可能多的金币，击杀敌人获取分数，同时避免掉落或受到伤害

## 角色能力
- **双段跳**：玩家可以在空中再次按下跳跃键执行第二段跳跃，最多可跳跃2次
- **动态动画**：角色根据移动状态自动切换闲置、奔跑、跳跃和受伤动画
- **血量系统**：玩家拥有100点血量，每次受到伤害会减少10点血量
- **无敌时间**：受伤后有1秒无敌时间，角色会闪烁表示无敌状态
- **受伤反馈**：受伤时会播放受伤音效并短暂向上弹起

## 敌人系统
- **史莱姆敌人**：沿着平台自动移动，移动速度为45像素/秒
- **智能巡逻**：使用两组射线检测技术（墙壁检测和地面边缘检测）避免掉落平台
- **敌人类型**：普通史莱姆敌人，可通过调整移动速度参数创建不同难度的敌人
- **踩踏击杀**：玩家可以通过踩踏敌人头部区域来击杀它们并获得反弹力
- **危险接触**：玩家碰到敌人会受到10点伤害并短暂无敌，血量为零时死亡
- **击杀奖励**：击杀敌人会增加分数并显示飘字效果

## 收集系统
- **金币收集**：玩家可以收集场景中的金币增加分数，每个金币增加1分
- **击杀计数**：击杀敌人会同时增加击杀计数和金币数
- **视觉反馈**：收集金币时会播放收集动画和音效，并显示"+1"飘字效果
- **计分板**：UI界面实时显示已收集的金币数量和击杀敌人数量
- **信号系统**：使用Godot信号系统在UI和游戏管理器之间传递分数变化

## 传送门系统
- **关卡传送**：传送门可以配置为传送到指定关卡或自动进入下一关
- **场景传送**：支持传送到任意场景的指定位置
- **视觉效果**：传送门具有蓝色发光效果、粒子特效和闪烁动画
- **防重复触发**：传送门被触发后会自动禁用，防止重复传送
- **管理器集成**：与TeleportManager和LevelManager深度集成，支持传送特效和关卡管理
- **配置灵活**：支持代码配置和运行时动态修改传送目标
- **错误处理**：完整的错误检查和调试信息输出

## 死亡机制
- **掉落死亡**：角色掉落超过Y坐标1000或进入死亡区域时立即死亡
- **血量耗尽**：血量降至零时角色死亡，播放死亡动画
- **复活效果**：死亡后会自动重新加载当前场景，角色会有1.5秒的淡入效果并获得额外的无敌时间
- **状态保持**：使用GameState单例在场景重载后保持玩家复活状态
- **延迟重载**：死亡后有1秒延迟再重新加载场景，给予玩家视觉反馈时间

# 核心设计文档

## 关卡管理系统

项目采用统一的关卡管理系统，提供模块化和数据驱动的开发方式：

### 核心组件
1. **LevelConfig资源** (level_config.gd)
   - 统一管理所有关卡配置信息
   - 包含关卡ID、名称、场景路径、难度等
   - 支持关卡解锁条件和目标设置

2. **LevelManager管理器** (level_manager.gd)
   - 负责关卡的加载、切换和状态管理
   - 提供关卡完成、失败、重新开始等功能
   - 管理关卡进度和分数系统

3. **关卡命名规范**
   - 场景文件：`level1.tscn`, `level2.tscn`, `level3.tscn`
   - 脚本文件：`level1.gd`, `level2.gd`, `level3.gd`
   - 统一的数字编号便于管理和扩展

### 关卡索引系统
- 详细的关卡列表和状态管理
- 标准化的关卡添加流程
- 开发状态跟踪和维护说明

## 模块设计
1. **角色控制模块** (player.gd)
   - 动画状态机管理
   - 物理运动处理
   - 与关卡管理器的信号通信

2. **敌人AI模块** (slime.gd)
   - 自动转向逻辑
   - 射线碰撞检测
   - 移动速度控制

3. **游戏管理模块** (game_manager.gd)
   - 场景切换
   - 分数统计
   - 游戏状态管理
   - 与关卡管理器集成

4. **收集系统模块** (coin.gd, coin_counter.gd)
   - 金币收集逻辑
   - 分数统计与显示
   - 视觉与音效反馈
   - 与关卡管理器的分数同步

5. **死亡区域模块** (killzone.gd)
   - 碰撞检测
   - 角色死亡处理
   - 通过关卡管理器处理失败

6. **反馈系统模块** (floating_text.gd)
   - 动态文本显示
   - 动画效果控制
   - 视觉反馈增强

## 技术实现细节

### 角色控制
- 使用Godot的CharacterBody2D实现物理移动
- 通过跟踪跳跃次数实现双段跳
- 使用动画状态机管理不同状态下的角色动画

### 敌人AI
- 使用射线检测实现边缘识别和自动转向
- 通过调整移动速度控制难度
- 简单但有效的巡逻行为模式

### 游戏管理
- 集中管理游戏状态和分数
- 使用信号系统实现模块间通信
- 提供游戏重置功能

### 用户界面
- 使用CanvasLayer实现固定位置UI
- 动态更新分数显示
- 提供即时视觉反馈

## 扩展规划

### 关卡系统扩展
- 关卡编辑器开发
- 程序化关卡生成
- 动态难度调整系统
- 关卡评分和成就系统
- 多主题关卡支持

### 游戏功能扩展
- 敌人基类和多样化敌人
- 技能树和角色升级系统
- 存档/读档功能
- 关卡解锁和进度系统
- 多人合作模式

### 技术优化
- 关卡流式加载
- 对象池管理
- 性能监控和优化
- 模块化组件系统
- 数据驱动配置管理

### 开发工具
- 可视化关卡编辑器
- 自动化测试工具
- 关卡验证系统
- 资源管理工具
- 版本控制集成