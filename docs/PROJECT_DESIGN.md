# FyGame 项目总设计文档

## 项目概述

FyGame 是一个基于 Godot 4 引擎开发的 2D 平台游戏项目。项目采用模块化设计，具有完整的系统架构、丰富的游戏机制和优化的性能表现。

## 技术架构

### 核心技术栈
- **游戏引擎**: Godot 4.x
- **编程语言**: GDScript
- **测试框架**: GUT (Godot Unit Test)
- **版本控制**: Git

### 项目结构
项目采用标准的 Godot 项目结构，按功能模块组织代码和资源：
- `scenes/` - 游戏场景文件
- `scripts/` - 脚本代码
- `resources/` - 游戏资源配置
- `assets/` - 美术和音频资源
- `docs/` - 项目文档
- `tests/` - 测试代码

## 核心模块设计

### 1. 游戏核心机制模块
**设计文档**: [游戏机制设计](./modules/game_mechanics.md)

游戏的基础机制系统，包括：
- 玩家控制系统
- 物理交互机制
- 碰撞检测系统
- 游戏状态管理
- 资源管理系统

**核心特性**：
- 流畅的 2D 平台跳跃机制
- 精确的碰撞检测
- 高效的资源管理
- 统一的状态管理

### 2. 玩家状态机模块
**设计文档**: [玩家状态机设计](./modules/player_state_machine.md)

管理玩家角色的各种状态和行为：
- 移动状态（行走、跑步、跳跃）
- 战斗状态（攻击、防御、受伤）
- 特殊状态（技能释放、无敌帧）
- 状态转换逻辑

**核心特性**：
- 基于有限状态机的设计
- 流畅的状态转换
- 可扩展的状态系统
- 动画与状态同步

### 3. 技能系统模块
**设计文档**: [技能系统设计](./modules/skill_system.md)

完整的技能系统实现：
- 技能定义和配置
- 技能释放机制
- 冷却时间管理
- 技能效果系统
- 技能升级机制

**核心特性**：
- 数据驱动的技能配置
- 灵活的技能效果系统
- 可视化的技能编辑器
- 性能优化的技能管理

### 4. 传送系统模块
**设计文档**: [传送系统设计](./modules/teleport_system.md)

游戏中的传送机制：
- 传送门系统
- 传送点管理
- 传送动画效果
- 传送条件检查
- 关卡间传送

**核心特性**：
- 可视化的传送门编辑
- 平滑的传送动画
- 灵活的传送条件
- 支持多种传送类型

### 5. 敌人AI与战斗模块
**设计文档**: [敌人AI与战斗设计](./modules/enemy_ai_combat.md)

敌人行为和战斗系统：
- AI 行为树系统
- 敌人状态机
- 战斗逻辑
- 伤害计算
- 敌人类型管理

**核心特性**：
- 智能的敌人AI
- 多样化的敌人类型
- 平衡的战斗系统
- 可配置的敌人属性

### 6. 关卡设计模块
**设计文档**: [关卡设计指南](./modules/level_design.md)

关卡设计和管理系统：
- 关卡结构设计
- 关卡加载系统
- 关卡进度管理
- 关卡编辑工具
- 关卡测试流程

**核心特性**：
- 模块化的关卡设计
- 高效的关卡加载
- 完善的进度保存
- 便捷的编辑工具

### 7. 音频系统模块
**设计文档**: [音频系统设计](./modules/audio_system.md)

完整的音频管理系统：
- 音效播放管理
- 背景音乐系统
- 音频对象池
- 音量控制
- 性能优化

**核心特性**：
- 高效的音频对象池
- 智能的音频管理
- 丰富的音频控制
- 性能监控和优化

### 8. UI系统模块
**设计文档**: [UI系统设计](./modules/ui_system.md)

用户界面系统：
- UI 组件设计
- 界面布局管理
- 交互逻辑
- 动画效果
- 响应式设计

**核心特性**：
- 模块化的UI组件
- 流畅的界面动画
- 一致的交互体验
- 优化的图标系统

### 9. 配置系统模块
**设计文档**: [配置系统设计](./modules/config_system.md)

游戏配置管理系统：
- 游戏设置管理
- 配置文件系统
- 运行时配置
- 配置验证
- 默认值管理

**核心特性**：
- 类型安全的配置
- 灵活的配置结构
- 实时配置更新
- 配置验证机制

## 系统集成

### 模块间通信
- **信号系统**: 使用 Godot 的信号机制实现模块间解耦通信
- **单例模式**: 核心管理器采用 AutoLoad 单例模式
- **事件总线**: 全局事件管理和分发

### 性能优化
- **对象池**: 频繁创建销毁的对象使用对象池管理
- **资源缓存**: 智能的资源缓存和清理机制
- **异步加载**: 大型资源的异步加载
- **性能监控**: 实时性能数据收集和分析

### 测试策略
- **单元测试**: 每个模块都有对应的单元测试
- **集成测试**: 模块间交互的集成测试
- **性能测试**: 关键功能的性能测试
- **自动化测试**: 基于 GUT 框架的自动化测试

## 开发规范

### 代码规范
- 遵循 GDScript 官方编码规范
- 统一的命名约定
- 完善的代码注释
- 模块化的代码结构

### 文档规范
- 每个模块都有详细的设计文档
- API 文档和使用示例
- 变更日志和版本记录
- 故障排除指南

### 版本控制
- 语义化版本号
- 清晰的提交信息
- 分支管理策略
- 代码审查流程

## 项目路线图

### 已完成功能
- ✅ 基础游戏机制
- ✅ 玩家状态机（含完整状态：idle, run, jump, fall, dash, slide, wall_slide, wall_jump, hurt, death）
- ✅ 技能系统
- ✅ 传送系统
- ✅ 音频系统
- ✅ 配置系统
- ✅ 测试框架
- ✅ 存档系统（SaveManager）
- ✅ UI系统（主菜单、暂停菜单、设置界面、存档界面、技能升级UI、GM面板）

### 开发中功能
- 🔄 敌人AI系统优化
- 🔄 关卡编辑器

### 计划功能
- 📋 成就系统
- 📋 多语言支持
- 📋 性能分析工具

## 贡献指南

### 开发环境
1. 安装 Godot 4.x
2. 克隆项目仓库
3. 安装 GUT 测试框架
4. 阅读项目文档

### 开发流程
1. 创建功能分支
2. 实现功能和测试
3. 更新相关文档
4. 提交代码审查
5. 合并到主分支

### 文档维护
- 新功能需要更新设计文档
- API 变更需要更新接口文档
- 重要变更需要更新变更日志

---

**文档版本**: v1.1  
**最后更新**: 2026年2月  
**维护者**: FyGame 开发团队  

> 本文档是项目的总体设计概览，详细的模块设计请参考各模块的具体设计文档。