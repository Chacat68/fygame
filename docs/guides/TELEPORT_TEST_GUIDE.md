# 传送功能测试指南

## 🎯 测试目的

验证新实现的传送系统是否正常工作，包括：
- 传送管理器初始化
- 配置文件加载
- Portal节点查找
- 传送冷却系统
- 配置预设功能
- 实际传送功能

## 🚀 运行测试

### 方法1: 在Godot编辑器中运行

1. 打开Godot编辑器
2. 加载项目 `/Users/charliefoo/Dev/Godot/fygame/project.godot`
3. 在场景面板中打开 `tests/integration/teleport_test_scene.tscn`
4. 点击运行按钮或按F5
5. 选择测试场景作为主场景

### 方法2: 直接运行测试脚本

在项目根目录下运行：
```bash
# 如果安装了Godot命令行工具
godot --path . --script test_teleport.gd

# 或者直接运行测试场景
godot --path . tests/integration/teleport_test_scene.tscn
```

## 🎮 测试交互

运行测试后，可以使用以下按键：

- **空格键**: 执行实际传送测试
- **R键**: 重新运行所有测试
- **ESC键**: 退出测试

## 📊 测试项目

### 1. 传送管理器初始化测试
- ✅ 验证TeleportManager类是否能正常创建
- ✅ 验证管理器是否能添加到场景树

### 2. 配置加载测试
- ✅ 验证默认配置文件是否存在
- ✅ 验证配置参数是否正确加载
- ✅ 验证Portal偏移量设置
- ✅ 验证冷却时间设置

### 3. Portal节点查找测试
- ✅ 测试通过组名查找Portal
- ✅ 测试通过节点名称查找Portal
- ⚠️ 如果Portal不存在会显示警告

### 4. 传送冷却系统测试
- ✅ 验证初始状态是否可以传送
- ✅ 验证事件信号是否正确连接
- ✅ 测试冷却时间机制

### 5. 配置预设测试
- ✅ 测试INSTANT预设配置
- ✅ 测试SMOOTH预设配置
- ✅ 验证配置验证功能

### 6. 实际传送测试
- 🚀 测试真实的传送功能
- 📍 验证玩家是否正确传送到Portal位置
- ⏱️ 测试传送冷却是否生效

## 📋 测试结果解读

### 成功标识 ✅
- 功能正常工作
- 配置正确加载
- 系统运行正常

### 警告标识 ⚠️
- 功能可能受限但不影响核心功能
- 通常是因为测试环境缺少某些节点
- 例如：Portal节点未添加到场景

### 错误标识 ❌
- 功能无法正常工作
- 需要修复的问题
- 可能影响传送系统正常运行

## 🔧 常见问题排查

### 问题1: Portal查找失败
**现象**: 显示"通过组查找Portal失败"或"通过名称查找Portal失败"

**解决方案**:
1. 确保场景中有Portal节点
2. 确保Portal节点已添加到"portal"组
3. 检查Portal节点名称是否为"Portal"

### 问题2: 配置加载失败
**现象**: 显示"配置文件加载失败"

**解决方案**:
1. 确保 `resources/default_teleport_config.tres` 文件存在
2. 检查文件路径是否正确
3. 验证配置文件格式是否正确

### 问题3: 传送管理器创建失败
**现象**: 显示"传送管理器创建失败"

**解决方案**:
1. 确保 `scripts/systems/teleport_manager.gd` 文件存在
2. 检查脚本语法是否正确
3. 验证TeleportManager类定义是否正确

### 问题4: 实际传送失败
**现象**: 按空格键后显示传送失败

**可能原因**:
1. 场景中没有玩家节点
2. 场景中没有Portal节点
3. 传送距离超出限制
4. 传送正在冷却中

## 📈 性能测试

测试还会验证以下性能相关项目：
- 传送管理器内存使用
- 配置加载速度
- 节点查找效率
- 事件信号响应时间

## 🎯 测试通过标准

一个完整的传送系统测试应该满足：
- 所有基础功能测试通过（✅）
- 警告项目不超过2个（⚠️）
- 无严重错误（❌）
- 实际传送功能正常工作

## 📝 测试报告

测试完成后，控制台会显示：
- 成功项目数量
- 警告项目数量
- 错误项目数量
- 总体测试结果

如果所有测试通过，会显示：
🎉 **传送系统基础功能测试通过！**

## 🔄 持续测试

建议在以下情况下重新运行测试：
- 修改传送系统代码后
- 更新配置文件后
- 添加新的传送功能后
- 发现传送相关问题时

---

**注意**: 这个测试主要验证传送系统的基础功能。完整的游戏测试还需要在实际游戏场景中进行。