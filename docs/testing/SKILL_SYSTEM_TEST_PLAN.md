# 技能系统测试计划

## 概述

本测试计划旨在确保技能系统的各个组件正常工作，包括技能解锁、升级、冷却、使用以及与玩家状态机的集成。测试将覆盖功能测试、性能测试和兼容性测试。

## 测试环境

- Godot引擎版本：4.x
- 测试场景：`scenes/test/skill_test_scene.tscn`
- 测试平台：Windows、macOS、Linux

## 测试类型

### 1. 功能测试

#### 1.1 技能解锁测试

| 测试ID | 测试描述 | 前置条件 | 测试步骤 | 预期结果 |
|--------|---------|---------|---------|----------|
| F1.1.1 | 解锁冲刺技能 | 玩家有足够金币 | 1. 打开技能升级UI<br>2. 点击冲刺技能的解锁按钮 | 1. 金币减少相应数量<br>2. 冲刺技能被解锁<br>3. UI更新显示技能已解锁 |
| F1.1.2 | 尝试解锁金币不足 | 玩家金币不足 | 1. 打开技能升级UI<br>2. 尝试点击解锁按钮 | 1. 解锁按钮为禁用状态<br>2. 点击无效<br>3. 技能保持未解锁状态 |
| F1.1.3 | 解锁所有技能 | 玩家有足够金币 | 1. 打开技能升级UI<br>2. 依次解锁所有技能 | 所有技能都被成功解锁 |

#### 1.2 技能升级测试

| 测试ID | 测试描述 | 前置条件 | 测试步骤 | 预期结果 |
|--------|---------|---------|---------|----------|
| F1.2.1 | 升级冲刺技能 | 冲刺技能已解锁，玩家有足够金币 | 1. 打开技能升级UI<br>2. 点击冲刺技能的升级按钮 | 1. 金币减少相应数量<br>2. 冲刺技能等级提升<br>3. UI更新显示新等级 |
| F1.2.2 | 尝试升级金币不足 | 技能已解锁，玩家金币不足 | 1. 打开技能升级UI<br>2. 尝试点击升级按钮 | 1. 升级按钮为禁用状态<br>2. 点击无效<br>3. 技能等级保持不变 |
| F1.2.3 | 升级到最高等级 | 技能已解锁，玩家有足够金币 | 1. 打开技能升级UI<br>2. 多次点击升级按钮直到最高等级 | 1. 技能达到最高等级<br>2. 升级按钮变为禁用状态<br>3. 显示"已达最高等级" |

#### 1.3 技能冷却测试

| 测试ID | 测试描述 | 前置条件 | 测试步骤 | 预期结果 |
|--------|---------|---------|---------|----------|
| F1.3.1 | 冲刺技能冷却 | 冲刺技能已解锁 | 1. 使用冲刺技能<br>2. 立即尝试再次使用 | 1. 第一次使用成功<br>2. 第二次使用失败<br>3. 调试面板显示冷却时间 |
| F1.3.2 | 等待冷却完成 | 技能在冷却中 | 1. 使用技能<br>2. 等待冷却时间结束<br>3. 再次使用技能 | 1. 冷却时间结束后<br>2. 成功再次使用技能 |
| F1.3.3 | 技能等级影响冷却 | 技能已升级 | 1. 使用技能<br>2. 记录冷却时间<br>3. 升级技能<br>4. 再次使用并记录冷却时间 | 升级后的冷却时间应短于升级前 |

#### 1.4 技能使用测试

| 测试ID | 测试描述 | 前置条件 | 测试步骤 | 预期结果 |
|--------|---------|---------|---------|----------|
| F1.4.1 | 使用冲刺技能 | 冲刺技能已解锁且不在冷却中 | 按X或Shift键 | 1. 玩家快速向前冲刺<br>2. 冲刺动画播放<br>3. 冷却时间开始计时 |
| F1.4.2 | 使用墙跳技能 | 墙跳技能已解锁且不在冷却中 | 1. 靠近墙壁<br>2. 按空格键 | 1. 玩家从墙上跳开<br>2. 墙跳动画播放<br>3. 冷却时间开始计时 |
| F1.4.3 | 使用滑铲技能 | 滑铲技能已解锁且不在冷却中 | 按S或Down键 | 1. 玩家进入滑铲状态<br>2. 碰撞体积变小<br>3. 滑铲动画播放<br>4. 冷却时间开始计时 |

#### 1.5 技能参数测试

| 测试ID | 测试描述 | 前置条件 | 测试步骤 | 预期结果 |
|--------|---------|---------|---------|----------|
| F1.5.1 | 冲刺距离随等级增加 | 冲刺技能已升级 | 1. 记录等级1的冲刺距离<br>2. 升级技能<br>3. 记录新的冲刺距离 | 升级后的冲刺距离应大于升级前 |
| F1.5.2 | 墙跳次数随等级增加 | 墙跳技能已升级 | 1. 记录等级1的最大墙跳次数<br>2. 升级技能<br>3. 记录新的最大墙跳次数 | 升级后的墙跳次数应大于升级前 |
| F1.5.3 | 滑铲持续时间随等级增加 | 滑铲技能已升级 | 1. 记录等级1的滑铲持续时间<br>2. 升级技能<br>3. 记录新的滑铲持续时间 | 升级后的滑铲持续时间应大于升级前 |

### 2. 集成测试

#### 2.1 与玩家状态机集成测试

| 测试ID | 测试描述 | 前置条件 | 测试步骤 | 预期结果 |
|--------|---------|---------|---------|----------|
| I2.1.1 | 从跑步状态进入冲刺 | 冲刺技能已解锁 | 1. 使玩家处于跑步状态<br>2. 按冲刺键 | 玩家从跑步状态切换到冲刺状态 |
| I2.1.2 | 从跳跃状态进入冲刺 | 冲刺技能已解锁 | 1. 使玩家处于跳跃状态<br>2. 按冲刺键 | 玩家从跳跃状态切换到冲刺状态 |
| I2.1.3 | 从冲刺状态返回正常状态 | 冲刺技能已使用 | 等待冲刺结束 | 玩家根据情况返回到Idle、Run或Fall状态 |

#### 2.2 与输入系统集成测试

| 测试ID | 测试描述 | 前置条件 | 测试步骤 | 预期结果 |
|--------|---------|---------|---------|----------|
| I2.2.1 | 技能输入映射测试 | 技能已解锁 | 1. 按各种技能键<br>2. 检查技能是否激活 | 输入映射正确触发对应技能 |
| I2.2.2 | 技能输入优先级测试 | 多个技能已解锁 | 同时按下多个技能键 | 按照预定优先级触发技能 |
| I2.2.3 | 禁用状态下的输入测试 | 玩家处于禁用技能的状态（如受伤） | 尝试使用技能 | 技能不应被触发 |

#### 2.3 与UI系统集成测试

| 测试ID | 测试描述 | 前置条件 | 测试步骤 | 预期结果 |
|--------|---------|---------|---------|----------|
| I2.3.1 | 技能UI显示测试 | 游戏运行中 | 打开技能升级UI | UI正确显示所有技能的状态 |
| I2.3.2 | 技能UI更新测试 | 技能升级UI打开 | 解锁或升级技能 | UI实时更新显示新的技能状态 |
| I2.3.3 | 金币UI更新测试 | 技能升级UI打开 | 解锁或升级技能 | 金币数量UI实时更新 |

### 3. 性能测试

| 测试ID | 测试描述 | 前置条件 | 测试步骤 | 预期结果 |
|--------|---------|---------|---------|----------|
| P3.1 | 技能冷却性能测试 | 多个技能在冷却中 | 监控FPS和CPU使用率 | 性能影响应该最小 |
| P3.2 | 技能效果性能测试 | 频繁使用技能 | 监控FPS和CPU使用率 | 性能影响应该在可接受范围内 |
| P3.3 | 技能UI性能测试 | 打开/关闭技能UI | 监控FPS和内存使用 | UI操作不应导致明显的性能下降 |

### 4. 兼容性测试

| 测试ID | 测试描述 | 前置条件 | 测试步骤 | 预期结果 |
|--------|---------|---------|---------|----------|
| C4.1 | 不同平台测试 | 在Windows、macOS和Linux上部署 | 在各平台上运行测试场景 | 技能系统在所有平台上正常工作 |
| C4.2 | 不同输入设备测试 | 连接键盘、游戏手柄等 | 使用不同输入设备测试技能 | 技能系统支持所有输入设备 |
| C4.3 | 不同分辨率测试 | 设置不同的游戏分辨率 | 测试技能UI在不同分辨率下的显示 | UI在所有分辨率下正确显示 |

## 测试数据和变量

### 技能参数

| 技能 | 参数 | 等级1 | 等级2 | 等级3 |
|------|------|-------|-------|-------|
| 冲刺 | 距离 | 120 | 140 | 160 |
| 冲刺 | 速度 | 600 | 650 | 700 |
| 冲刺 | 持续时间 | 0.2 | 0.22 | 0.24 |
| 冲刺 | 冷却时间 | 2.0 | 1.7 | 1.4 |
| 墙跳 | 力度 | 300 | 330 | 360 |
| 墙跳 | 水平推力 | 200 | 220 | 240 |
| 墙跳 | 最大次数 | 1 | 2 | 3 |
| 墙跳 | 冷却时间 | 0.5 | 0.4 | 0.3 |
| 滑铲 | 速度 | 300 | 330 | 360 |
| 滑铲 | 持续时间 | 0.5 | 0.6 | 0.7 |
| 滑铲 | 冷却时间 | 1.5 | 1.2 | 0.9 |

### 金币成本

| 技能 | 解锁成本 | 升级成本（每级） |
|------|---------|----------------|
| 冲刺 | 100 | 150 |
| 墙跳 | 150 | 200 |
| 滑铲 | 120 | 180 |

## 测试工具

- 调试面板：显示技能状态、冷却时间和玩家状态
- 性能监视器：监控FPS、CPU和内存使用
- 输入记录器：记录玩家输入序列

## 测试流程

1. 准备测试环境
   - 打开测试场景
   - 确保调试工具可用

2. 执行功能测试
   - 按照测试用例逐一测试
   - 记录测试结果

3. 执行集成测试
   - 测试技能系统与其他系统的交互
   - 记录测试结果

4. 执行性能测试
   - 监控性能指标
   - 记录测试结果

5. 执行兼容性测试
   - 在不同环境下测试
   - 记录测试结果

6. 分析测试结果
   - 识别问题和缺陷
   - 提出改进建议

7. 修复问题
   - 修复发现的缺陷
   - 重新测试修复后的功能

## 测试报告模板

```
# 技能系统测试报告

## 测试信息

- 测试日期：[日期]
- 测试人员：[姓名]
- 测试环境：[环境详情]

## 测试结果摘要

- 通过测试用例数：[数量]
- 失败测试用例数：[数量]
- 未测试用例数：[数量]

## 详细测试结果

| 测试ID | 测试描述 | 结果 | 备注 |
|--------|---------|------|------|
| [ID] | [描述] | [通过/失败] | [备注] |

## 发现的问题

1. [问题描述]
   - 严重程度：[高/中/低]
   - 重现步骤：[步骤]
   - 预期结果：[结果]
   - 实际结果：[结果]

## 改进建议

1. [建议描述]

## 结论

[总体评价和结论]
```

## 自动化测试

为了提高测试效率，可以考虑实现以下自动化测试：

1. 单元测试
   - 测试技能管理器的核心功能
   - 测试技能参数计算

2. 集成测试
   - 测试技能状态与玩家状态机的集成
   - 测试技能UI与技能管理器的集成

3. 性能测试
   - 自动化性能监控和报告

## 结论

本测试计划提供了全面测试技能系统的框架。通过执行这些测试，可以确保技能系统的功能正确、性能良好，并与游戏的其他系统正确集成。测试结果将帮助识别问题并指导改进，最终提供更好的游戏体验。